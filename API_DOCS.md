# Документация API

## Общая информация

### Базовый URL:
Все запросы к API отправляются на базовый URL:
```
http://<ваш-домен>/api/
```

### Аутентификация:
API использует **JWT (JSON Web Token)** для аутентификации. Получите токен по следующему маршруту:

- `POST /api/token/` - Получение JWT токена.
    - Параметры:
        - `username`: Имя пользователя.
        - `password`: Пароль.
    - Ответ:
      ```json
      {
          "refresh": "<токен-обновления>",
          "access": "<токен-доступа>"
      }
      ```

- `POST /api/token/refresh/` - Обновление токена доступа.
    - Параметры:
        - `refresh`: Токен обновления.
    - Ответ:
      ```json
      {
          "access": "<новый-токен-доступа>"
      }
      ```

### Заголовки авторизации:
Добавьте следующий заголовок ко всем запросам:
```
Authorization: Bearer <токен-доступа>
```

---

## Консультации (Consultations)

### Общая информация:
Эндпоинты для работы с сущностью **Consultation** (консультация).

### Базовый маршрут:
```
/api/consultations/
```

### Методы:

#### 1. Получение списка консультаций
**GET** `/api/consultations/`

Возвращает список всех консультаций, доступных для текущего пользователя.

- **Параметры запроса (query):**
    - `status`: Фильтр по статусу консультации (строка).
    - `doctor_name`: Поиск консультаций по имени врача (строка).
    - `patient_name`: Поиск консультаций по имени пациента (строка).
    - `ordering`: Поле для сортировки. Например: `-created_at` (по умолчанию).

- **Ответ (200 OK):**
```json
[
    {
        "id": 1,
        "created_at": "2024-12-11T10:00:00Z",
        "start_time": "2024-12-12T12:00:00Z",
        "end_time": "2024-12-12T13:00:00Z",
        "status": "active",
        "doctor": {
            "id": 1,
            "full_name": "Иван Иванов",
            "specialization": "Кардиолог"
        },
        "patient": {
            "id": 2,
            "full_name": "Петр Петров",
            "age": 35
        },
        "clinic": {
            "id": 3,
            "name": "Клиника №1",
            "address": "ул. Ленина, д. 5"
        }
    },
    ...
]
```

#### 2. Создание консультации
**POST** `/api/consultations/`

Создает новую консультацию. Только для пользователей с соответствующими правами.

- **Тело запроса:**
```json
{
    "doctor_id": 1,
    "patient_id": 2,
    "clinic_id": 3,
    "start_time": "2024-12-12T12:00:00Z",
    "end_time": "2024-12-12T13:00:00Z",
    "status": "active"
}
```

- **Ответ (201 Created):**
```json
{
    "id": 1,
    "created_at": "2024-12-11T10:00:00Z",
    "start_time": "2024-12-12T12:00:00Z",
    "end_time": "2024-12-12T13:00:00Z",
    "status": "active",
    "doctor": {
        "id": 1,
        "full_name": "Иван Иванов",
        "specialization": "Кардиолог"
    },
    "patient": {
        "id": 2,
        "full_name": "Петр Петров",
        "age": 35
    },
    "clinic": {
        "id": 3,
        "name": "Клиника №1",
        "address": "ул. Ленина, д. 5"
    }
}
```

#### 3. Обновление консультации
**PATCH** `/api/consultations/{id}/`

Обновляет данные конкретной консультации. Только для пользователей с соответствующими правами.

- **Тело запроса:**
```json
{
    "status": "completed",
    "start_time": "2024-12-12T14:00:00Z"
}
```

- **Ответ (200 OK):**
```json
{
    "id": 1,
    "created_at": "2024-12-11T10:00:00Z",
    "start_time": "2024-12-12T14:00:00Z",
    "end_time": "2024-12-12T13:00:00Z",
    "status": "completed",
    "doctor": {
        "id": 1,
        "full_name": "Иван Иванов",
        "specialization": "Кардиолог"
    },
    "patient": {
        "id": 2,
        "full_name": "Петр Петров",
        "age": 35
    },
    "clinic": {
        "id": 3,
        "name": "Клиника №1",
        "address": "ул. Ленина, д. 5"
    }
}
```

#### 4. Удаление консультации
**DELETE** `/api/consultations/{id}/`

Удаляет конкретную консультацию. Только для пользователей с соответствующими правами.

- **Ответ (204 No Content):**

#### 5. Изменение статуса консультации
**PATCH** `/api/consultations/{id}/change_status/`

Изменяет статус конкретной консультации. Только для пользователей с правами изменения статуса.

- **Тело запроса:**
```json
{
    "status": "cancelled"
}
```

- **Ответы:**
    - **200 OK:** Успешное обновление статуса.
      ```json
      {
          "info": "Статус успешно обновлен"
      }
      ```
    - **404 Not Found:** Консультация не найдена.
      ```json
      {
          "error": "Консультация не найдена"
      }
      ```
    - **403 Forbidden:** У пользователя нет прав для изменения статуса.
      ```json
      {
          "error": "У вас нет прав на обновление"
      }
      ```
    - **400 Bad Request:** Неверный статус.
      ```json
      {
          "error": "Неверный статус"
      }
      ```

